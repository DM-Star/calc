<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0, minimum-scale=0.5">
    <title>数学练习工具</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- 主菜单界面 -->
        <div id="main-menu" class="screen active">
            <h1>数学练习工具</h1>
            
            <div class="practice-selector">
                <button class="practice-btn decimal" onclick="selectPractice('decimal')">十进制转二进制</button>
                <button class="practice-btn" onclick="selectPractice('arithmetic')">整数四则运算练习</button>
                <button class="practice-btn comprehensive" onclick="selectPractice('comprehensive')">综合四则运算练习</button>
                <button class="practice-btn gomoku" onclick="selectPractice('gomoku')" style="display: none;">五子棋对战</button>
            </div>
            
            <div class="info-button-container">
                <button class="info-btn" onclick="showUpdateLog()">
                    ℹ️ 更新日志
                </button>
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <a href="ob.html" style="color: #007bff; text-decoration: none; font-size: 16px;">观察力训练</a>
            </div>
            
            <div class="author-info" style="margin-top: 30px; color: #666; font-size: 14px; text-align: center;">
                作者：王宇轩
            </div>
        </div>

        <!-- 十进制转二进制设置界面 -->
        <div id="decimal-setup" class="screen">
            <h1>十进制转二进制</h1>
            
            <!-- 随机数种设置 -->
            <div class="seed-selector" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                <label style="display: block; margin-bottom: 10px;">
                    <strong>随机数种（可选）：</strong><br>
                </label>
                <input type="number" id="decimal-random-seed" placeholder="留空则随机生成" min="1" max="999999" 
                       style="padding: 8px; width: 200px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <!-- 显示当前随机数种 -->
            <div class="current-seed" style="margin: 10px 0; padding: 10px; background: #e9ecef; border-radius: 5px;">
                <strong>当前随机数种：</strong>
                <span id="decimal-seed-value">随机生成</span>
            </div>
            
            <div class="range-selector">
                <label>
                    选择数字范围：
                    <input type="number" id="min-range" value="1" min="1">
                    到
                    <input type="number" id="max-range" value="100" min="2">
                </label>
            </div>
            <button onclick="startDecimalPractice()">开始练习</button>
            <button onclick="showScreen('main-menu')">返回主菜单</button>
        </div>

        <!-- 整数四则运算设置界面 -->
        <div id="arithmetic-setup" class="screen">
            <h1>整数四则运算练习</h1>
            
            <!-- 随机数种设置 -->
            <div class="seed-selector" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                <label style="display: block; margin-bottom: 10px;">
                    <strong>随机数种（可选）：</strong><br>
                </label>
                <input type="number" id="arithmetic-random-seed" placeholder="留空则随机生成" min="1" max="999999" 
                       style="padding: 8px; width: 200px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <!-- 显示当前随机数种 -->
            <div class="current-seed" style="margin: 10px 0; padding: 10px; background: #e9ecef; border-radius: 5px;">
                <strong>当前随机数种：</strong>
                <span id="arithmetic-seed-value">随机生成</span>
            </div>
            
            <div class="range-selector">
                <label>
                    选择数字范围：
                    <input type="number" id="arithmetic-min-range" value="1" min="1">
                    到
                    <input type="number" id="arithmetic-max-range" value="50" min="2">
                </label>
            </div>
            <div class="operation-selector">
                <label><input type="checkbox" name="operation" value="+" checked> 加法</label>
                <label><input type="checkbox" name="operation" value="-" checked> 减法</label>
                <label><input type="checkbox" name="operation" value="*" checked> 乘法</label>
                <label><input type="checkbox" name="operation" value="/" checked> 除法</label>
            </div>
            <button onclick="startArithmeticPractice()">开始练习</button>
            <button onclick="showScreen('main-menu')">返回主菜单</button>
        </div>

        <!-- 综合四则运算设置界面 -->
        <div id="comprehensive-setup" class="screen">
            <h1>综合四则运算练习</h1>
            
            <!-- 随机数种设置 -->
            <div class="seed-selector" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                <label style="display: block; margin-bottom: 10px;">
                    <strong>随机数种（可选）：</strong><br>
                </label>
                <input type="number" id="comprehensive-random-seed" placeholder="留空则随机生成" min="1" max="999999" 
                       style="padding: 8px; width: 200px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <!-- 显示当前随机数种 -->
            <div class="current-seed" style="margin: 10px 0; padding: 10px; background: #e9ecef; border-radius: 5px;">
                <strong>当前随机数种：</strong>
                <span id="comprehensive-seed-value">随机生成</span>
            </div>
            
            <div class="range-selector">
                <label>
                    选择运算数范围：
                    <input type="number" id="comprehensive-min-range" value="11" min="1">
                    到
                    <input type="number" id="comprehensive-max-range" value="100" min="2">
                </label>
            </div>
            <div class="number-selector">
                <label>
                    选择运算数数量：
                    <input type="number" id="number-count" value="3" min="2" max="6">
                    (2-6个)
                </label>
            </div>
            <div class="operation-selector">
                <label><input type="checkbox" name="comprehensive-operation" value="+" checked> 加法</label>
                <label><input type="checkbox" name="comprehensive-operation" value="-" checked> 减法</label>
                <label><input type="checkbox" name="comprehensive-operation" value="*" checked> 乘法</label>
                <label><input type="checkbox" name="comprehensive-operation" value="/" checked> 除法</label>
            </div>
            <button onclick="startComprehensivePractice()">开始练习</button>
            <button onclick="showScreen('main-menu')">返回主菜单</button>
        </div>

        <!-- 五子棋对战设置界面 -->
        <div id="gomoku-setup" class="screen">
            <h1>五子棋对战</h1>
            
            <!-- 玩家姓名设置 -->
            <div class="player-setup" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                <label style="display: block; margin-bottom: 10px;">
                    <strong>请输入您的姓名：</strong><br>
                </label>
                <input type="text" id="player-name" placeholder="请输入姓名" 
                       style="padding: 8px; width: 200px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <!-- 房间操作选择 -->
            <div class="room-actions" style="margin: 20px 0;">
                <div class="action-group">
                    <button class="action-btn primary" onclick="createGomokuRoom()">创建房间</button>
                    <div class="action-description">创建新房间并获取房间号</div>
                </div>
                
                <div class="action-group" style="margin-top: 15px;">
                    <input type="text" id="room-code" placeholder="输入房间号" 
                           style="padding: 8px; width: 150px; border: 1px solid #ddd; border-radius: 4px; margin-right: 10px;">
                    <button class="action-btn secondary" onclick="joinGomokuRoom()">加入房间</button>
                    <div class="action-description">输入房间号加入已有房间</div>
                </div>
            </div>
            
            <!-- 房间状态显示 -->
            <div class="room-status" id="room-status" style="margin: 20px 0; padding: 15px; background: #e9ecef; border-radius: 5px; display: none;">
                <strong>房间状态：</strong>
                <span id="room-info"></span>
            </div>
            
            <div class="button-group">
                <button onclick="showScreen('main-menu')">返回主菜单</button>
            </div>
        </div>

        <!-- 五子棋对战界面 -->
        <div id="gomoku-game" class="screen">
            <h1>五子棋对战</h1>
            
            <!-- 房间信息显示 -->
            <div class="room-info-panel" style="margin: 20px 0; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px; text-align: center;">
                <div class="room-code-label" style="font-size: 14px; opacity: 0.8;">房间号</div>
                <div class="room-code" id="current-room-code" style="font-size: 32px; font-weight: bold; letter-spacing: 2px; margin: 10px 0;">等待连接...</div>
                <button onclick="copyRoomCode()" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.5); padding: 5px 15px; border-radius: 20px; cursor: pointer;">
                    复制房间号
                </button>
                <div id="copy-feedback" style="font-size: 12px; margin-top: 5px; opacity: 0.8;"></div>
            </div>
            
            <!-- 玩家信息 -->
            <div class="player-info" style="display: flex; justify-content: space-between; margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                <div class="player-self">
                    <strong>我方：</strong>
                    <span id="self-player-name">玩家1</span>
                    <span id="self-player-symbol" style="margin-left: 10px;">⚫</span>
                </div>
                <div class="game-status" id="game-status">
                    <strong>状态：</strong>
                    <span id="current-turn">等待开始...</span>
                </div>
                <div class="player-opponent">
                    <strong>对方：</strong>
                    <span id="opponent-player-name">玩家2</span>
                    <span id="opponent-player-symbol" style="margin-left: 10px;">⚪</span>
                </div>
            </div>
            
            <!-- 棋盘容器 -->
            <div class="board-container" style="text-align: center; margin: 20px 0;">
                <canvas id="gomoku-board" width="450" height="450" 
                        style="border: 2px solid #333; background: #f0d9b5; cursor: pointer;"></canvas>
            </div>
            
            <!-- 操作按钮 -->
            <div class="game-controls" style="margin: 20px 0;">
                <button class="action-btn" onclick="restartGomokuGame()">重新开始</button>
                <button class="action-btn surrender" onclick="surrenderGame()">认输</button>
                <button class="action-btn draw" onclick="requestDraw()">和棋</button>
                <button class="action-btn secondary" onclick="exitGomokuGame()">退出游戏</button>
            </div>
            
            <!-- 聊天区域 -->
            <div class="chat-container" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                <h3>聊天</h3>
                <div id="chat-messages" style="height: 100px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; background: white;">
                    <div style="color: #666;">聊天区域 - 可以在这里与对手交流</div>
                </div>
                <div style="display: flex;">
                    <input type="text" id="chat-input" placeholder="输入消息..." 
                           style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; margin-right: 10px;">
                    <button onclick="sendChatMessage()">发送</button>
                </div>
            </div>
        </div>

        <!-- 练习界面 -->
        <div id="practice-screen" class="screen">
            <h1 id="practice-title">练习标题</h1>
            
            <div class="progress">
                <div>进度：<span id="current-question">1</span>/10</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
            
            <div class="question-container">
                <div class="question" id="question-text"></div>
                <input type="text" class="answer-input" id="answer-input" placeholder="请输入答案">
                <div class="feedback" id="feedback"></div>
            </div>
            
            <div class="button-group">
                <button onclick="checkAnswer()">提交答案</button>
                <button class="skip" id="skip-btn" onclick="skipQuestion()" style="display: none;">跳过此题</button>
                <button class="exit" onclick="exitPractice()">退出练习</button>
            </div>
        </div>

        <!-- 结果界面 -->
        <div id="result-screen" class="screen">
            <h1>练习结果</h1>
            
            <div class="total-time" id="total-time"></div>
            
            <div class="results-list" id="results-list"></div>
            
            <div class="button-group">
                <button onclick="copyShareLink()" style="background: #28a745;">复制分享链接</button>
                <button onclick="restartPractice()">重新开始</button>
                <button onclick="showScreen('main-menu')">返回主菜单</button>
            </div>
        </div>

        <!-- 更新日志界面 -->
        <div id="update-log-screen" class="screen">
            <div style="margin-bottom: 20px; text-align: center;">
                <button onclick="showScreen('main-menu')" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; margin-bottom: 10px;">
                    ← 返回主菜单
                </button>
                <h1 style="margin: 0;">更新日志</h1>
            </div>
            
            <div id="update-log-content" style="max-width: 800px; margin: 0 auto; padding: 20px; line-height: 1.6; font-size: 14px;">
                <!-- 更新日志内容将在这里动态加载 -->
            </div>
        </div>


    </div>
    
    <!-- 添加PeerJS库引用 -->
    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <script src="script.js"></script>
</body>
</html>